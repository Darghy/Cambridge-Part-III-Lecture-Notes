\documentclass{article}
%build with recipe latexmk
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage{fancyhdr}
\pagestyle{fancy}

\usepackage{tcolorbox}
\tcbuselibrary{theorems}
\usepackage{babel}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
%\usepackage{a4wide}
\usepackage{float}
\usepackage{tikz-cd}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{wrapfig}
\usepackage{setspace}
\setstretch{1.1}
\usepackage{color}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true, %set true if you want colored links
    linktoc=all,     %set to all if you want both sections and subsections linked
    linkcolor=black,  %choose some color if you want links to stand out
}

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{cor}[theorem]{Corollary}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{example}{Example}[section]
\newtheorem{defn}{Definition}[section]

\title{Part III - Elliptic Curves
    \\ \large
    Lectured by Tom Fisher 
}
 
\author{Artur Avameri}
\date{}
 
\setcounter{section}{-1}
 
\begin{document}
\maketitle
\tableofcontents
\newpage
 
\section{Introduction}

\marginpar{19 Jan 2024, Lecture 1}


The best books for the course include \textit{The arithmetic of elliptic curves} by Silverman, Springer 1996, and \textit{Lectures on elliptic curves} by Cassels, CUP 1991. 

\section{Fermat's Method of Infinite Descent}

A right--angled triangle $\Delta$ has $a^2+b^2=c^2$ and $\text{area}(\Delta) = \frac{1}{2}ab$.
\begin{defn}
    $\Delta$ is \textbf{rational} if $a,b,c \in \mathbb{Q}$. $\Delta$ is \textbf{primitive} if $a,b,c \in \mathbb{Z}$ are coprime.
\end{defn}
Note that a primitive triangle has pairwise coprime side lengths because $a^2+b^2=c^2$.
\begin{lemma}\label{lemma1.1}
    Every primitive triangle is of the form $(u^2-v^2, 2uv, u^2+v^2)$ for some integers $u > v > 0$.
\end{lemma}
\begin{proof}
    WLOG let $a,b,c$ be odd, even, odd. Then $\left(\frac{b}{2}\right)^2 = \frac{c+a}{2}\frac{c-a}{2}$, where we note that the RHS is a product of positive coprime integers. By unique factorization, $\frac{c+a}{2} = u^2, \frac{c-a}{2}=v^2$ for $u,v \in \mathbb{Z}$. This gives the desired result.
\end{proof}
\begin{defn}
    $D \in \mathbb{Q}_{>0}$ is a \textbf{congruent} number if there exists a rational triangle $\Delta$ with $\text{area}(\Delta)=D$.
\end{defn}
Note that it suffices to consider $D \in \mathbb{Z}_{> 0}$ squarefree.
\begin{example}
    $D=5,6$ are congruent.
\end{example} 
\begin{lemma}\label{lemma1.2}
    $D \in \mathbb{Q}_{>0}$ is congruent $\iff Dy^2 = x^3-x$ for some ${x,y \in \mathbb{Q}, y \neq 0}$.
\end{lemma}
\begin{proof}
    Lemma \ref{lemma1.1} shows that $D$ congruent $\implies Dw^2 = uv(u^2-v^2)$ for some $u,v,w \in \mathbb{Q}, w \neq 0$. This implication also obviously goes the other way. To finish, divide through by $w^4$ and take $x = \frac{u}{v}, y = \frac{w}{v^2}$.
\end{proof}
Fermat showed that $1$ is not a congruent number.
\begin{theorem}\label{theorem1.3}
    There is no solution to $w^2 = uv(u+v)(u-v)$ for $u,v,w \in \mathbb{Z}, w \neq 0$.
\end{theorem}
\begin{proof}
    WLOG assume $u,v$ are coprime and that $u,w > 0$. If $v<0$, then replace $(u,v,w)$ by $(-v,u,w)$. If $u,v$ are both odd, then replace $(u,v,w)$ by $\left(\frac{u+v}{2},\frac{u-v}{2},\frac{w}{2}\right)$. Then $u,v,u+v,u-v$ are pairwise coprime positive integers with their product a square, so by unique factorization in $\mathbb{Z}$, $u=a^2, v = b^2, u+v = c^2, u-v = d^2$ for $a,b,c,d \in \mathbb{Z}$. 
    \vspace{1mm}
     
    Since $u \not\equiv v \pmod{2}$, both $c$ and $d$ are odd. Then $\left(\frac{c+d}{2}\right)^2 + \left(\frac{c-d}{2}\right)^2 = \frac{c^2+d^2}{2} = u = a^2$. This gives a primitive triangle with area $\frac{c^2-d^2}{8} = \frac{v}{4} = \left(\frac{b^2}{2}\right)$. Let $w_1 = \frac{b}{2}$, then by Lemma \ref{lemma1.1}, $w_1^2 = u_1v_1(u_1+v_1)(u_1-v_1)$ for some $u_1, v_1 \in \mathbb{Z}$. Hence we have a new solution to our original question, with $4w_1^2 = b^2 = v \mid w^2 \implies w_1 \le \frac{w}{2}$, so we're done by infinite descent.
\end{proof}
\vspace{1mm}
 
\textbf{A variant for polynomials.} In the above, $K$ is a field with $\text{char }K \neq 2$. Let $\overline{K}$ be the algebraic closure of $K$ and consider for this whole section $K$ with $\text{char }K \neq 2$.

\begin{lemma}\label{lemma1.4}
    Let $u,v \in K[t]$ be coprime. If $\alpha u + \beta v$ is a square for 4 distinct $(\alpha : \beta) \in \mathbb{P}^1$, then $u, v \in K$.
\end{lemma}
\begin{proof}
    WLOG let $K = \overline{K}$ by extending if necessary. Changing coordinates on $\mathbb{P}^1$ (i.e. multiplying by a $2 \times 2$ invertible matrix), we may assume that the points $(\alpha : \beta)$ are $(1 : 0)$, $(0 : 1)$, $(1: -1)$, $(1: - \lambda)$ for $\lambda \in K \setminus \{0,1\}$. Since our field is algebraically closed, let $\mu = \sqrt{\lambda}$. Then $u = a^2, v = b^2, u-v = (a+b)(a-b), u - \lambda v = (a + \mu b)(a - \mu b)$.
    \vspace{1mm}
     
    Unique factorization in $K[t]$ implies that $a+b, a-b, a+ \mu b, a- \mu b$ are squares (since the necessary terms are coprime up to units, i.e. constants). But $\max(\text{deg}(a), \text{deg}(b)) \le \frac{1}{2}\max(\text{deg}(u),\text{deg}(v))$, so by Fermat's method of infinite descent, $u, v \in K$.
\end{proof}
\begin{defn}
    \begin{enumerate}[(i)]
        \item An \textbf{elliptic curve} $E/K$ is the projective closure of the plane affine curve $y^2 = f(x)$ (this is called a Weierstrass equation) where $f \in K[x]$ is a monic cubic polynomial with distinct roots in $\overline{K}$.
        \item For $L/K$ any field extension, $E(L) = \{(x,y) \in L^2 \mid y^2 = f(x)\} \cup \{0\}$ (the point at infinity in the projective closure), it turns out that $E(L)$ is naturally an abelian group.  
    \end{enumerate}
\end{defn}
In this course, we study $E(K)$ for $K$ a finite field, local field, number field.
\vspace{1mm}
 
Lemma \ref{lemma1.2} and Theorem \ref{theorem1.3} show that if $E : y^2 = x^3-x$, then $E(\mathbb{Q}) = \{0, (0,0), (\pm 1, 0)\}$.

\begin{cor}\label{cor1.5}
    Let $E/K$ be an elliptic curve. Then $E(K(t)) = E(K)$.
\end{cor}
\begin{proof}
    WLOG $K = \overline{K}$. By a change of coordinates, we may assume $y^2 = x(x-1)(x-\lambda)$ for some $\lambda \in K\setminus \{0,1\}$. Suppose $(x,y) \in E(K(t))$. Write $x = \frac{u}{v}$ for $u,v \in K(t)$ coprime. Then $w^2 = uv(u-v)(u-\lambda v)$ for some $w \in K[t]$. Unique factorization in $K[t]$ shows that $u,v, u-v, u- \lambda v$ are all squares, so by Lemma \ref{lemma1.4}, $u, v \in K$, so $x, y \in K$.
\end{proof}

\section{Some remarks on algebraic curves}

\marginpar{22 Jan 2024, Lecture 2}

In this section, work over an algebraically closed field $K = \overline{K}$.

\begin{defn}\label{defn2.1}
    A plane curve $C = \{f(x,y) = 0\} \subset \mathbb{A}^2$ (for $f \in K[x,y]$ irreducible) is \textbf{rational} if it has a rational parametrization, i.e. $\exists \phi, \psi \in K(t)$ such that
    \begin{enumerate}[(i)]
        \item The map $\mathbb{A}^1 \to \mathbb{A}^2$ by $t \mapsto (\phi(t), \psi(t))$ is injective on $\mathbb{A}^1\setminus \{\text{finite set}\}$.
        \item $f(\phi(t),\psi(t))=0$ in $K(t)$.
    \end{enumerate}
\end{defn}
\begin{example}
    \begin{enumerate}[(a)]
        \item Any nonsingular conic is rational. For example, for $x^2+y^2=1$, take a line with slope $t$ through $(-1,0)$ (the anchor) and solve to get the rational parametrization $(x,y) = \left(\frac{1-t^2}{1+t^2},\frac{2t}{1+t^2}\right)$.
        \item Any singular plane cubic is rational, for example $y^2=x^3$ giving $(x,y) = (t^2, t^3)$ with the anchor at the singularity $(0,0)$ and $y^2 = x^2(x+1)$ with the parametrization to be computed on Ex. Sheet 1 (anchor still at $(0,0)$).
        \item Corollary \ref{cor1.5} shows that elliptic curves are not rational.
    \end{enumerate}
\end{example}
\textbf{Remark.}
The genus $g(C) \in \mathbb{Z}_{\ge 0}$ is an invariant of a smooth projective curve $C$. If $K=\mathbb{C}$, then $g(C)$ is the genus of the Riemann surface. A smooth plane curve $C \subset \mathbb{P}^2$ of degree $d$ has genus $g(C) = \frac{(d-1)(d-2)}{2}$.
\begin{prop}
    (Here we still assume $K = \overline{K}$). Let $C$ be a smooth projective curve.
    \begin{itemize}
        \item $C$ is rational (see Definition \ref{defn2.1})$\iff$ $g(C)=0$.
        \item $C$ is an elliptic curve $\iff$ $g(C)=1$.
    \end{itemize}
\end{prop}
\begin{proof}
    \begin{enumerate}[(i)]
        \item Omitted.
        \item $(\implies)$: Check $C$ is a smooth plane curve in $\mathbb{P}^2$ (see Ex. Sheet 1) and use the above remark.
        \vspace{1mm}
         
        $(\impliedby)$: We will see this later.
    \end{enumerate}
\end{proof}

\vspace{1mm}
 
\textbf{Order of vanishing.} Let $C$ be an algebraic curve with function field $K(C)$ and let $P \in C$ be a smooth point. Write $\text{ord}_P(f)$ for the order of vanishing of $f \in K(C)$ at $P$ (which is negative if $f$ has a pole at $P$).
\vspace{1mm}
 
\textbf{Fact.} $\text{ord}_P : K(C)^\times \to \mathbb{Z}$ is a discrete valuation, i.e. $\text{ord}_P(f_1f_2) = \text{ord}_P(f_1) + \text{ord}_P(f_2)$ and $\text{ord}_P(f_1+f_2)\ge \min(\text{ord}_P(f_1),\text{ord}_P(f_2))$. 

\begin{defn}
    We say $t \in K(C)^\times$ is a \textbf{uniformizer} at $P$ if $\text{ord}_P(t)=1$.
\end{defn}
\begin{example}
    $C =\{g = 0\} \subset \mathbb{A}^2$ for $g \in K[x,y]$. Then $K(C) = \text{Frac}\left(\frac{K[x,y]}{(g)}\right)$. Write $g = g_0+g_1(x,y) + g_2(x,y) + \ldots$ for $g_i$ homogeneous of degree $i$. Suppose $P = (0,0)$ is a smooth point, e.g. $g_0=0$ and let $g_1(x,y)=\alpha x + \beta y$ with $\alpha,\beta$ not both zero ($\alpha x + \beta y =0$ gives a tangent to the curve at $P$). Let $\gamma,\delta \in K$ and consider also the line $\gamma x + \delta y$ through $P$. Then it is a fact that $\gamma x + \delta y \in K(C)$ is a uniformizer at $P$ if and only if $\alpha \delta - \beta \gamma \neq 0$. 
\end{example}
\begin{example}\label{ex2.3}
    Consider $\{y^2 = x(x-1)(x-\lambda)\} \subset \mathbb{A}^2$ for $\lambda \neq 0,1$ and consider its projective closure by taking $x =\frac{X}{Z}, y = \frac{Y}{Z}$ to get $\{Y^2Z = X(X-Z)(X-\lambda Z)\} \subset \mathbb{P}^2$. This has only one point at infinity, $P = (0 : 1 : 0)$. Our aim is to compute $\text{ord}_P(x)$ and $\text{ord}_P(y)$.
    \vspace{1mm}
     
    For this, put $t = \frac{X}{Y}, w =\frac{Z}{Y}$, so $w \stackrel{(\dagger)}{=}  t(t-w)(t-\lambda w) $. Now $P$ is the point $(t,w) = (0,0)$, which is a smooth point with $\text{ord}_P(t) = \text{ord}_P(t-w) = \text{ord}_P(t-\lambda w) = 1$, so $(\dagger)$ gives $\text{ord}_P(w) = 3$. We now find
    \begin{align*}
        &\text{ord}_P(x) = \text{ord}_P\left(\frac{X}{Z}\right) = \text{ord}_P\left(\frac{t}{w}\right) = 1-3 = -2\\
        &\text{ord}_P(y) = \text{ord}_P\left(\frac{Y}{Z}\right) = \text{ord}_P\left(\frac{1}{w}\right) = -3.
    \end{align*}
\end{example}

\textbf{Riemann--Roch space.} Let $C$ be a smooth projective curve. 
\begin{defn}
    A \textbf{divisor} is a formal sum of points on $C$, say $D = \sum_{P \in C}^{} n_P P$ where $n_P \in \mathbb{Z}$ and $n_P = 0$ for all but finitely many $P \in C$. We say $\text{deg }D= \sum_{P \in C}^{} n_P$.
    \vspace{1mm}
     
    $D$ is \textbf{effective} (written $D\ge 0$) if $n_P \ge 0 ~\forall P \in C$. If $f \in K(C)^\times$, then $\text{div}(f) = \sum_{P \in C}^{} \text{ord}_P(f)P$. The Riemann--Roch space of $D \in \text{Div}(C)$ is  
    \[
        \mathcal{L}(D) = \{f \in K(C)^\times \mid \text{div}(f) + D \ge 0\} \cup \{0\},
    \]
    i.e. the $K$--vector space of rational functions on $C$ with ''poles no worse than specified by $D$''.
\end{defn}
We quote Riemann--Roch for surfaces of genus 1: We have
\begin{align*}
    \text{dim }\mathcal{L}(D) = \begin{cases}
        \text{deg }D &\text{if deg }D>0\\
        0 \text{ or }1 &\text{if deg }D=0\\
        0 &\text{if deg }D<0.
    \end{cases}
\end{align*}
\begin{example}
    We revisit Example \ref{ex2.3}. We have $\mathcal{L}(2P) = \langle 1,x \rangle$ and $\mathcal{L}(3P) = \langle 1,x,y \rangle$.
\end{example}

\marginpar{24 Jan 2024, Lecture 3}

We still have $\text{char }K \neq 2$ and $\overline{K} = K$.

\begin{prop}\label{prop2.2}
    Let $C \subset \mathbb{P}^2$ be a smooth plane cubic and let $P \in C$ be a point of inflection. Then we may change coordinates such that $C : Y^2Z = X(X-z)(X-\lambda Z)$ and $P = (0:1:0)$ (for some $\lambda \neq 0,1$).
\end{prop}
\begin{proof}
    First change coordinates such that $P = (0:1:0)$. Then change coordinates such that the tangent line becomes $T_p C = \{Z = 0\}$. Say $C = \{F(X,Y,Z) = 0\} \subset  \mathbb{P}^2$. A point on the tangent line is of the form $(t:1:0)$ and since $P \in C$ is a point of inflection, we get $F(t,1,0) = \text{const}\cdot t^3$, i.e. $F$ has no terms $X^2Y, XY^2$ or $Y^3$.
    \vspace{1mm}
     
    Hence $F = \langle Y^2Z, XYZ, YZ^2, X^3, X^2Z, XZ^2, Z^3 \rangle$. Notably, $Y^2Z$ has a nonzero coefficient, otherwise $P \in C$ would be singular, a contradition to $C$ being smooth. The coefficient of $X^3$ is nonzero as well, otherwise $Z \mid F$. We are free to rescale $X,Y,Z,F$, so WLOG $C$ is defined by \[
    Y^2Z + a_1 XYZ + a_3 YZ^2 = X^3 + a_2 X^2 Z + a_4 XZ^2 + a_6 Z^3.
    \]
    Substituting $Y \mapsto Y - \frac{1}{2}a_1 X - \frac{1}{2}a_3 Z$, we may assume $a_1 = a_3 = 0$. This gives \[
    C : Y^2Z = Z^3 f \left(\frac{X}{Z}\right)
    \]
    for a monic cubic polynomial $f$. Since $C$ is smooth, $f$ has distinct roots, WLOG $0,1,\lambda$, so $C: Y^2Z = X(X-Z)(X-\lambda Z)$.
\end{proof}
The form $Y^2Z + a_1 XYZ + a_3 YZ^2 = X^3 + a_2 X^2 Z + a_4 XZ^2 + a_6 Z^3$ is the Weierstrass form. The form $ Y^2Z = X(X-Z)(X-\lambda Z)$ is the Legendre form.

\textbf{Remark.} It can be shown that the points of inflection of a plane curve $C = \{F(X_1,X_2,X_3) = 0\} \subset \mathbb{P}^2$ are given by solving the Hessian:
\[
\begin{cases}
    &F = \left(\frac{\partial^2 F}{\partial X_i \partial X_j} \right) = 0\\
    &F(X_1,X_2,X_3) = 0.
\end{cases}
\]
\subsection{The degree of a morphism}
Let $\phi : C_1 \to C_2$ be a nonconstant morphism of smooth projective curves. Then $\phi^* : K(C_2) \to K(C_1)$ by $f \mapsto f \circ \phi$, giving an injective map $\phi^* K(C_2)$ to $K(C_1)$.

\begin{defn}
    The \textbf{degree} of $\phi$ is $\text{deg }\phi = [K(C_1) : \phi^* K(C_2)]$.
    \vspace{1mm}
     
    We say $\phi$ is \textbf{separable} if $K(C_1)/\phi^* K(C_2)$ is a separable field extension.
\end{defn}

Suppose $P \in C_1, Q \in C_2$ and $\phi : P \mapsto Q$. Let $t \in K(C_2)$ be a uniformizer at $Q$.
\begin{defn}
    $e_{\phi}(P) = \text{ord}_P(\phi^* t)$, which is always $\ge 1$ and independent of $t$.
\end{defn}
\begin{theorem}
    Let $\phi : C_1 \to C_2$ be a nonconstant morphism of smooth projective curves. Then \[
    \sum_{P \in \phi^{-1}(Q)}^{} e_{\phi}(P) = \deg \phi ~\forall  Q \in C_2.
    \]
    Moreover, if $\phi$ is separable, then $e_{\phi}(P)=1$ for all but infitely many $P \in C_1$.
\end{theorem}
We don't prove this.
\vspace{1mm}
 
In particular, this shows that:
\begin{itemize}
    \item $\phi$ is surjective (very important here that we're in $\overline{K}$).
    \item $|\phi^{-1}(Q)|\le \deg \phi$.
    \item If $\phi$ is separable, then equality holds in (ii) for all but finitely many points $Q \in C_2$.
\end{itemize}
\textbf{Remark.} Let $C$ be an algebraic curve. A rational map is given by 
\begin{align*}
    C &\to \mathbb{P}^n \\
    \phi &\mapsto (f_0,f_1,\ldots,f_n)
\end{align*}
where $f_0,\ldots,f_n \in K(C)$ are not all zero. Then we have a fact: If $C$ is smooth, then $\phi$ is a morphism. This saves us a lot of time (we can go from a rational map to a morphism immediately).

\section{Weierstrass equations}

We now drop the assumption that $\overline{K} = K$, but we will still assume that $K$ is perfect.

\begin{defn}
    An \textbf{elliptic curve} $E/K$ is a smooth projective curve of genus 1 defined over $K$ with a specified $K$--rational point $O = O_E$.
\end{defn}
\begin{example}
    $\{X^3 + pY^3 + p^2Z^3 = 0\} \subset \mathbb{P}^2$ is not an elliptic curve over $\mathbb{Q}$, since it has no $\mathbb{Q}$--rational point.
\end{example}
\begin{theorem}
    Every elliptic curve $E$ is isomorphic over $K$ to a curve in Weierstrass form via an isomorphism taking $O_E$ to $(0:1:0)$.
\end{theorem}
\textbf{Remark.} Proposition \ref{prop2.2} treated the special case where $E$ is a smooth plane cubic and $O_E$ is a point of inflection.
\vspace{1mm}
 
\textbf{Fact.} If $D \in \text{Div}(E)$ is defined over $K$, then $\mathcal{L}(D)$ has a basis in $K(E)$ (not just in $\overline{K}(E)$). Here $D$ is defined over $K$ if it is fixed by $\text{Gal}(\overline{K}/K)$ (this is unimportant for us and we just write it down to be rigorous).

\begin{proof}
    $\mathcal{L}(2\cdot O_E) \subset \mathcal{L}(3\cdot O_E)$. Pick bases $1,x$ and $1,x,y$. Note $\text{ord}_{O_E}(x) = -2$ and $\text{ord}_{O_E}(y) = -3$ (else $x,y$ don't give a basis). The 7 elements $1,x,y,x^2,xy,x^3,y^2$ lie in the 6--dimensional vector space $\mathcal{L}(6O_E)$ (as they have at most a sixth order pole), so they must satisfy a linear dependence relation. 

    \vspace{1mm}
     
    Leaving out $x^3$ or $y^2$ leaves us with 6 elements, all with different order poles, giving a basis for $\mathcal{L}(6O_E)$. Hence the coefficients of $x^3$ and $y^2$ are nonzero, so by rescaling $x,y$ (if necessary) we get \[
    E': y^2 + a_1xy + a_2y = x^3 + a_2 x^2 + a_4 x + a_6
    \]
    for some $a_i \in K$. Let $E'$ be the curve defined by this equation (or rather its projective closure). There is a morphism $\phi: E \to E' \subset \mathbb{P}^2$ by $P \mapsto (x(P):y(P):1) = \left(\frac{x}{y}(P): 1: \frac{1}{y}(P)\right)$. (Since $E$ is smooth, we know that this rational map is a morphism). Hence $O_E \mapsto (0:1:0)$.
    \vspace{1mm}
     
    We have $E \stackrel{x}{\to} \mathbb{P}^1$ by $x \mapsto (x:1)$ (and similarly for $y$), so 
    \begin{align*}
        &[K(E):K(x)] = \deg(E \stackrel{x}{\to} \mathbb{P}^1) = \text{ord}_{O_E}\left(\frac{1}{x}\right) = 2\\
        &[K(E):K(y)] = \deg(E \stackrel{y}{\to} \mathbb{P}^1) = \text{ord}_{O_E}\left(\frac{1}{y}\right) = 3.
    \end{align*}
    This gives an inclusion of fields $K(x) \le K(E)$ of degree 2, $K(y) \le K(E)$ of degree 3, while $K(x), K(y) \le K(x,y) \le  K(E)$, so tower law gives $[K(E):K(x,y)] = 1 \implies K(E)=K(x,y)=\phi^* K(E') \implies \deg \phi = 1$. (draw a picture!). This gives us an inverse that is a rational map, which we want to show is a morphism. For this, we just need to show that $E'$ is smooth.
    \vspace{1mm}
     
    If $E'$ were singular, then $E$ and $E'$ are rational, a contradiction. So $E'$ is smooth and hence $\phi^{-1}$ is a morphism, so $\phi$ is an isomorphism.
\end{proof}
\begin{prop}\label{prop3.2}
    Let $E,E'$ be elliptic curves over $K$ in Weierstrass form. Then $E \cong E'$ over $K \iff$ the equations are related by a change of variables 
    \begin{align*}
    x &= u^2x' + r \\
    y &= u^3y' + u^2sx' + t
    \end{align*}
    for $r,s,t,u \in K$ with $u \neq 0$. 
\end{prop}
\begin{proof}
    $\mathcal{L}(2\cdot O_E) = \langle 1, x \rangle = \langle 1, x' \rangle \implies x = \lambda x' + r$ for some ${\lambda, r \in K, \lambda \neq 0}$. Similarly $\mathcal{L}(3\cdot O_E) = \langle 1,x,y \rangle = \langle 1,x',y' \rangle \implies y = \mu y' + \sigma x' + t$ for some $\mu, \sigma, t \in K, \mu \neq 0$. 
    \vspace{1mm}
     
    Looking at the coefficients of $x^3$ and $y^2$ tells us that $\lambda^3 = \mu^2$, so $\lambda = u^2, \mu = u^3$ for some $u \in K^\times$. Put $s = \frac{\sigma}{u^2}$ to conclude.
\end{proof}

A Weierstrass equation defines an elliptic curve $\iff$ it defines a smooth curve $\iff \Delta(a_1,\ldots,a_6) \neq 0$, where $\Delta \in \mathbb{Z}[a_1,\ldots,a_6]$ is a certain polynomial.

\vspace{1mm}
 
If $\text{char }K \neq 2,3$, we may reduce to the case $E: y^2 = x^3 + ax + b$. In this case, the discriminant is $\Delta = -16(4a^3 + 27b^2)$.
\begin{cor}
    Assume $\text{char }K \neq 2,3$. Elliptic curves 
    \begin{align*}
        &E : y^2 = x^3 + ax + b \\
        &E' : y^2 = x^3 + a'x + b'
    \end{align*}
    are isomorphic over $K \iff \begin{cases}
        a' = u^4 a \\
        b' = u^6 b
    \end{cases}$ for some $u \in K^\times$.
\end{cor}
\begin{proof}
    $E, E'$ are related by a substitution as in Proposition \ref{prop3.2} with $r=s=t=0$.
\end{proof}
\begin{defn}
    The \textbf{$j$--invariant} is $j(E) = \frac{1728(4a^3)}{4a^3+27b^2}$.
\end{defn}
\begin{cor}
    $E \cong E' \implies j(E) \cong j(E')$ and the converse holds if $K = \overline{K}$.
\end{cor}
\begin{proof}
    $E \cong E' \iff \begin{cases}
        a' &= u^4 a \\
        b' &= u^6 b
    \end{cases}$ for some $u \in K^\times \implies (a^3:b^2) = ((a')^3:(b')^2) \iff j(E) = j(E')$. The middle step is reversible if $K=\overline{K}$.
\end{proof}
\section{The Group Law}
Let $E \subset \mathbb{P}^2$ be a smooth plane cubic with $O_E \in E(K)$ (not immediately assumed to be in Weierstrass form). $E$ meets any line in 3 points, counted with multiplicity.
\vspace{1mm}
 
For $P,Q \in E$, let $S$ be the $3^{\text{rd}}$ point of intersction of $PQ$ with $E$ and then let $R$ be the $3^{\text{rd}}$ intersection of $O_ES$ with $E$. We define $P \oplus Q = R$. (Later we drop the circle and just write $+$). If $P=Q$, instead take the tangent line at $P$, i.e. $T_PE$, etc. This is the ''chord and tangent process''.
\begin{theorem}
    $(E, \oplus)$ is an abelian group.
\end{theorem}
\textbf{Remark.} Here $E$ means $E(\overline{K})$ since we haven't specified a field yet.
\begin{proof}
    \begin{enumerate}[(i)]
        \item $\oplus$ is commutative trivially.
        \item $O_E$ is the identity, since the line through $O_EP$ meets $S$ for the $3^{\text{rd}}$ time at $S$ and then $SP$ meets $E$ for the $3^{\text{rd}}$ time at $O_E$ (drawing a picture makes this obvious).
        \item Inverses: Let $S$ be the $3^{\text{rd}}$ intersection of $T_{O_E}E$ with $E$ and $Q$ the $3^{\text{rd}}$ intersection of $PS$ with $E$. Then $P \oplus Q = O_E$.
        \item Associativity is much harder. We have some setup:
    \end{enumerate}
    \begin{defn}
        $D_1,D_2 \in \text{Div}(E)$ are \textbf{linearly equivalent} if $\exists f \in K(E)^\times$ such that $\text{div}(f) = D_1 - D_2$. Write $D_1 \sim D_2$ and $[D] = \{D' \mid D' \sim D\}$.
    \end{defn}
    \begin{defn}
        The \textbf{Picard group} is $\text{Pic}(E) = \text{Div}(E)/\sim$. Also define $\text{Pic}^0(E) = \text{Div}^0(E)/\sim$ where $\text{Div}^0(E) = \{D \in \text{Div}(E) \mid \text{deg}(D) = 0\}$.
    \end{defn}
    We define $\psi: E \to \text{Pic}^0(E)$ by $P \mapsto [(P)-(O_E)]$.
    \begin{prop}
        \begin{enumerate}[(i)]
            \item $\psi(P \oplus Q) = \psi(P) + \psi(Q)$.
            \item $\psi$ is a bijection.
        \end{enumerate}
    \end{prop}
    \begin{proof}
        \begin{enumerate}[(i)]
            \item WLOG let the lines $PQ$ and $O_ES$ be given by $l=0$ and $m=0$. Then \[
            \text{div}\left(\frac{l}{m}\right) = (P)+(S)+(Q)-(O_E)-(S)-(R),
            \]
            hence $(P)+(Q) \sim (P \oplus Q) + (O_E)$, so $(P\oplus Q)- (O_E) \sim (P)-(O_E) + (Q) - (O_E)$, so $\psi(P \oplus Q) = \psi(P) + \psi(Q)$.
            \item Injectivity: Suppose $\psi(P) = \psi(Q)$ for $P \neq Q$. Then $\exists f \in \overline{K}(E)^\times$ such that $\text{div}(f) = (P)-(O_E)-(Q)+(O_E) = (P) - (Q) \implies E \stackrel{f}{\to} \mathbb{P}^1$ has degree $1$ (for example since evaluation at 0 on the affine line gives that $P$ has one root and $Q$ has one pole), so $E \cong \mathbb{P}^1$, a contradiction.
            \vspace{1mm}
             
            Surjectivity: Let $[D] \in \text{Pic}^0(E)$. Then $D + (O_E)$ has degree 1, so by Riemann--Roch, $\text{dim}\mathcal{L}(D+(O_E)) = 1$, so $\exists 0\neq f \in \overline{K}(E)$ such that $\text{div}(f) + D + (O_E) \ge 0$, but $\text{div}(f) + D + (O_E)$ has degree 1, so $\text{div}(f) + D + (O_E) = (P)$ for some $P \in E \implies (P) - (O_E) \sim D \implies  \psi(P) = [D]$. 
        \end{enumerate}
    \end{proof}
    We conclude that $\psi$ identifies $(E,\oplus)$ with $(\text{Pic}^0(E), +)$, so $\oplus$ is associative.
\end{proof}

\end{document}
