\documentclass{article}
%build with recipe latexmk
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage{fancyhdr}
\pagestyle{fancy}

\usepackage{tcolorbox}
\tcbuselibrary{theorems}
\usepackage{babel}
\usepackage{enumerate}
\usepackage{mathtools}
\usepackage{amsmath, amssymb, amsthm}
%\usepackage{a4wide}
\usepackage{float}
\usepackage{tikz-cd}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{wrapfig}
\usepackage{setspace}
\setstretch{1.1}
\usepackage{color}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true, %set true if you want colored links
    linktoc=all,     %set to all if you want both sections and subsections linked
    linkcolor=black,  %choose some color if you want links to stand out
}

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{cor}[theorem]{Corollary}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{example}{Example}[section]
\newtheorem{defn}{Definition}[section]

\title{Part III - Local Fields
    \\ \large
    Lectured by Rong Zhou 
}
 
\author{Artur Avameri}
\date{}
 
\setcounter{section}{-1}
 
\begin{document}
\maketitle
\tableofcontents
\newpage
 
\section{Introduction}

This is a first class in graduate algebraic number theory. Something we'd like to do is solve diophantine equations, e.g. $f(x_1,\ldots,x_r) \in \mathbb{Z}[x_1,\ldots,x_r]$. In general, solving $f(x_1,\ldots,x_r) = 0$ is very difficult. A simpler question we might consider is solving $f(x_1,\ldots,x_r) \equiv 0 \pmod{p}$, or $\pmod{p^2}, \pmod{p^3}$, etc. Local fields package all of this information together. 

\section{Absolute values}
\begin{defn}
    Let $K$ be a field. An \textbf{absolute value} on $K$ is a function $|\cdot| : K \to \mathbb{R}_{\ge 0}$ satisfying:
    \begin{enumerate}[(1)]
        \item $|x| = 0 \iff x = 0$.
        \item $|xy| = |x||y| ~\forall x,y \in K$.
        \item $|x+y|\le |x|+|y| ~\forall x,y \in K$ (triangle inequality).
    \end{enumerate}
\end{defn}
We say that $(K, |\cdot|)$ is a \textbf{valued field}.
Examples:
\begin{itemize}
    \item Take $K=\mathbb{Q},\mathbb{R},\mathbb{C}$ with the usual absolute value $|a+ib| = \sqrt{a^2+b^2}$. We call this $|\cdot |_{\infty}$.
    \item For $K$ any field, we have the trivial absolute value $|x| = \begin{cases}
        0 & \text{ if } x = 0\\
        1 & \text{ else.}
    \end{cases}$
    We will ignore this in this course.
    \item Take $K= \mathbb{Q}$ and $p$ a prime. For $0 \neq x \in \mathbb{Q}$, write $x = p^n \frac{a}{b}$ where $(a,p)=(b,p)=1$. Then the \textbf{$p$--adic absolute value} is defined to be \[
    |x|_p = \begin{cases}
        0 & x=0\\
        p^{-n} & x = p^n\frac{a}{b}.
    \end{cases}
    \] 
    We can check the axioms:
    \begin{enumerate}[(1)]
        \item The first axiom is clear.
        \item $$|xy|_p = \left|p^{n+m}\frac{ac}{bd}\right|_p = p^{-(n+m)} = |x|_p|y|_p.$$
        \item WLOG let $m\ge n$. Then \[
        |x+y|_p = \left|p^n\left(\frac{ad+p^{m-n}bc}{bd}\right)\right|_p \le p^{-n} = \max(|x|_p, |y|_p).
        \]
    \end{enumerate}
\end{itemize}

Any absolute value $|\cdot |$ on $K$ induces a metric $d(x,y) = |x-y|$ on $K$, hence induces a topology on $K$.

\begin{defn}
    Suppose we have two absolute values $|\cdot |, |\cdot |'$ on $K$. We say these absolute values are \textbf{equivalent} if they induce the same topology. An equivalence class is called a \textbf{place}.
\end{defn}
\begin{prop}
    Let $|\cdot|, |\cdot|'$ be (nontrivial) absolute values on $K$. Then the following are equivalent:
    \begin{enumerate}[(i)]
        \item $|\cdot|$ and $|\cdot|'$ are equivalent.
        \item $|x| < 1 \iff |x|' < 1 ~\forall x \in K$.
        \item $\exists c \in \mathbb{R}_{>0}$ such that $|x|^c = |x'| ~\forall x \in K$.
    \end{enumerate}
\end{prop}
\begin{proof}
    (i) $\implies $(ii): $|x|<1 \iff x^n \to 0$ with respect to $|\cdot| \iff x^n \to 0$ with respect to $|\cdot|'$ (since the topologies are the same) $\iff |x|'<1$. 
    \vspace{1mm}
     
    (ii) $\implies $(iii): Note that $|x|^c = |x|' \iff c \log |x| = \log |x|'$. Take $a \in K^\times$ such that $|a| > 1$. This exists since $|\cdot|$ is nontrivial. We need to show that $\forall x \in K^\times,$\[
     \frac{\log |x|}{\log |a|} = \frac{\log|x|'}{\log|a|'}.
    \]
    Assume $\frac{\log |x|}{\log |a|} < \frac{\log|x|'}{\log|a|'}.$ Choose $m, n \in \mathbb{Z}$ such that $\frac{\log |x|}{\log |a|} < \frac{m}{n} < \frac{\log|x|'}{\log|a|'}.$ We then have 
    \begin{align*}
        &\begin{cases}
            &n \log |x| < m \log |a|\\
            &n \log |x|' > m \log|a|'
        \end{cases}\\
        \implies & \left|\frac{x^n}{a^m}\right|<1, \left|\frac{x^n}{a^m}\right|' > 1,
    \end{align*}
    a contradiction. The other inequality is analogous.
    \vspace{1mm}
     
    (iii) $\implies$ (i): Clear, since they have the same open balls.
\end{proof}

\textbf{Remark.} $|\cdot|_{\infty}^2$ on $\mathbb{C}$ is not an absolute value by our definition (doesn't satisfy the triangle inequality). Some authors replace the triangle inquality by the condition $|x+y|^{\beta} \le |x|^{\beta} + |y|^{\beta}$ for some fixed $\beta \in \mathbb{R}_{>0}$. The equivalence classes are the same in either case.

In this course, we will mainly be interested in the following:

\begin{defn}
    An absolute value $|\cdot|$ on $K$ is said to be \textbf{non-archimedean} if it satisfies the \textbf{ultrametric inequality} \[
    |x+y|\le \max(|x|,|y|).
    \]
    If $|\cdot|$ is not non-archimedean, we say it is \textbf{archimedean}. 
\end{defn}
\begin{example}
    \begin{itemize}
        \item $|\cdot|_{\infty}$ on $\mathbb{R}$ is archimedean.
        \item $|\cdot|_{p}$ on $\mathbb{Q}$ is non--archimedean.
    \end{itemize}
\end{example}

\begin{lemma}
    Let $(K, |\cdot|)$ be non--archimedean and $x,y \in K$. If $|x|<|y|$, then $|x-y|= |y|$.
\end{lemma}
\begin{proof}
    On the one hand, $|x-y|\le \max(|x|,|y|) = |y|$ (using $|x|=|-x|$).
    \vspace{1mm}
     
    On the other, $|y| \le \max(|x|, |x-y|) = |x-y|$.
\end{proof}

Convergence is easier in non--archimedean fields:
\begin{prop}
    Let $(K,|\cdot|)$ be non--archimedean and $(x_n)_{n=1}^{\infty}$ a sequence on $K$. If $|x_n-x_{n+1}| \to 0$, then $(x_n)_{n=1}^{\infty}$ is Cauchy. In particular, if $K$ is complete, then the sequence converges.
\end{prop}
\begin{proof}
    For $\epsilon > 0 $, choose $N$ such that $|x_n-x_{n+1}| < \epsilon$ for $n \ge N$. Then for $N<n<m$, \[
    |x_n - x_m| = |(x_n - x_{n+1}) + (x_{n+1} - x_{n+2}) + \ldots + (x_{m-1}-x_m)| < \epsilon,
    \]
    so $(x_n)$ is Cauchy.
\end{proof}
\begin{example}
    For $p=5$, we can construct a sequence in $\mathbb{Q}$ satisfying:
    \begin{enumerate}[(i)]
        \item $x_n^2+1 \equiv  0 \pmod{5^n}$,
        \item $x_n \equiv x_{n+1} \pmod{5^n}$.
    \end{enumerate}
    We construct it by induction. Take $x_1=2$. Now suppose we've constructed $x_n$ and write $x_n^2+1 = a\cdot 5^n$ and set $x_{n+1} = x_n + b\cdot 5^n$. We compute \[
    x_{n+1}^2 + 1 = x_n^2 + 2b x_n 5^n + b^2 5^{2n} + 1 = a5^n + 2bx_n 5^n + \underbrace{b^2 5^{2n}}_{\equiv 0 \text{ (mod }5^{n+1})} + 1. 
    \]
    Hence we choose $b$ such that $a+2bx_n \equiv 0 \pmod{5}$ and we're done. 
    \vspace{1mm}
     
    Now (ii) tells us that $(x_n)$ is Cauchy, but we claim it doesn't converge. Suppose it does, $x_n \to l \in \mathbb{Q}$. Then $x_n^2 \to l^2 \in \mathbb{Q}$. But by (i), $x_n^2 \to -1$, so $l^2 = -1$, a contradiction.
\end{example}
This tells us that $(\mathbb{Q}, |\cdot|_{5})$ is not complete.
\begin{defn}
    The $p$--adic numbers $\mathbb{Q}_p$ are the completion of $\mathbb{Q}$ with respect to $|\cdot|_p$.
\end{defn}

\marginpar{10 Oct 2022, Lecture 2}

Let $(K,|\cdot|)$ be a non--archimedean valued field. For $x \in K$ and $r \in \mathbb{R}_{>0}$, we define $B(x,r) = \{y \in K \mid |y-x|<r\}$ and $\overline{B} = \{y \in K \mid |y-x|\le r\}$ to be the open and closed balls of radius $r$.

\begin{lemma}
    \begin{enumerate}[(i)]
        \item If $z \in B(x,r)$, then $B(z,r) = B(x,r)$, i.e. open balls don't have centers.
        \item If $z \in \overline{B}(x,r)$, then $\overline{B}(x,r) = \overline{B}(z,r)$.
        \item $B(x,r)$ is closed.
        \item $\overline{B}(x,r)$ is open.
    \end{enumerate}
\end{lemma}
\begin{proof}
    \begin{enumerate}[(i)]
        \item Let $y \in B(x,r)$. Then $|x-y|<r \implies |z-y| = |(z-x) + (x-y)| \le \max(|z-x|,|x-y|) < r$, so $B(x,r) \subset B(z,r)$. The reverse inclusion is analogous.
        \item Analogous to (i) by replacing $<$ with $\le$.
        \item Let $y \in K \setminus B(x,r)$. If $z \in B(x,r) \cap B(y,r)$, then $B(x,r) = B(z,r) = B(y,r)$ by (i), so $y \in B(x,r)$, a contradiction. Hence $B(x,r) \cap B(y,r) = \varnothing$. Since $y$ was arbitrary, $K \setminus B(x,r)$ is open, so $B(x,r)$ is closed.
        \item If $z \in \overline{B}(x,r)$, then $B(z,r) \subset \overline{B}(z,r) \stackrel{\text{(ii)}}{=} \overline{B}(x,r)$.
    \end{enumerate}
\end{proof}

\section{Valuation rings}
\begin{defn}
    Let $K$ be a field. A \textbf{valuation} on $K$ is a function $v : K^\times \to \mathbb{R}$ such that 
    \begin{enumerate}[(i)]
        \item $v(xy) = v(x)+v(y)$.
        \item $v(x+y) \ge \min(v(x),v(y))$.
    \end{enumerate}
\end{defn}
Fix $0<\alpha<1$. If $v$ is a valuation on $K$, then $|x| = \begin{cases}
    \alpha^{v(x)} & x \neq 0\\
    0 & x = 0
\end{cases}$
determines a non--archimedean absolute value on $K$. Conversely, a non--archimedean absolute value on $K$ determines a valuation $v(x) = \log_{\alpha} |x|$.

\textbf{Remark.} We ignore the trivial evaluation $v(x)=0 ~\forall x \in K$, which  corresponds to the trivial absolute value.

\begin{defn}
    We say valuations $v_1,v_2$ are equivalent if $\exists c \in \mathbb{R}_{>0}$ such that $v_1(x) = cv_2(x) ~\forall x \in K^{\times}$.
\end{defn}
\begin{example}
    \begin{itemize}
        \item If $K=\mathbb{Q}$, $v_p(x) = -\log_p |x|_p$ is the $p$--adic valuation.
        \item Let $k$ be a field. Let $K=k(t) = \text{Frac}(k[t])$ be a rational function field. We let \[
        v\left(t^n \frac{f(t)}{g(t)}\right) = n
        \]
        for $f, g \in k[t]$, $f(0)\neq 0, g(0) \neq 0$. This is called a $t$--adic valuation.
        \item Let $K = k((t)) = \text{Frac}(k[[t]]) = \{\sum_{i=n}^{\infty} a_i t^i \mid a_i \in k, n \in \mathbb{Z}\}$, the field of formal Laurent series over $k$. We define \[
        v\left(\sum_{i}^{} a_i t^i\right) = \min \{i \mid a_i \neq 0\},
        \]
        the $t$--adic valuation on $K$.
    \end{itemize}
\end{example}
\begin{defn}
    Let $(K, |\cdot|)$ be a non--archimedean valued field. The \textbf{valuation ring} of $K$ is defined to be \[
    \mathcal{O}_K = \{x \in K \mid |x|\le 1\}.
    \]
    (i.e. the closed unit ball, $\mathcal{O}_K = \overline{B}(0,1)$, or ${\mathcal{O}_K = \{x \in K^{\times} \mid v(x) \ge  0\} \cup \{0\}}$).
\end{defn}
\begin{prop}
    \begin{enumerate}[(i)]
        \item $\mathcal{O}_K$ is an open subring of $K$.
        \item The subsets $\{x \in K \mid |x|\le r\}$ and $\{x \in K \mid |x|< r\}$ for $r\le 1$ are open ideals in $\mathcal{O}_K$.
        \item $\mathcal{O}_K^\times = \{x \in K \mid |x|=1\}$.
    \end{enumerate}
\end{prop}
\begin{proof}
    \begin{enumerate}[(i)]
        \item We find:
        \begin{itemize}
            \item $|0|=0$ and $|1|=1$, so $0,1 \in \mathcal{O}_K$.
            \item If $x \in \mathcal{O}_K$, then $|-x|=|x| \implies -x \in \mathcal{O}_K$. 
            \item If $x,y \in \mathcal{O}_K$, then $|x+y|\le \max(|x|,|y|)\le 1$, so $x+y \in \mathcal{O}_K$. 
            \item If $x,y \in \mathcal{O}_K$, then $|xy| = |x||y| \le 1$, so $xy \in \mathcal{O}_K$.
        \end{itemize}
        Thus $\mathcal{O}_K$ is a subring, and since $\mathcal{O}_K = \overline{B}(0,1)$, it is open.
        \item As $r\le 1$, $\{x \in K \mid |x|\le r\} = \overline{B}(0,r) \subset \mathcal{O}_K$, so it is open. We find:
        \begin{itemize}
            \item If $x, y \in \overline{B}(0,r)$, then $|x+y|\le \max(|x|,|y|) \le r$, so $x+y \in \overline{B}_r$.
            \item If $x \in \mathcal{O}_K, y \in \overline{B}_r$, then $|xy|=|x||y|\le 1 \cdot |y|\le r$, so $xy \in \overline{B}_r$.
        \end{itemize}
        Hence this is an open ideal. The proof for $\{x \in K \mid |x|< r\}$ is analogous.
        \item Note that $|x||x^{-1}|= |x x^{-1}| = 1$. Thus $|x| = 1 \iff |x^{-1}| = 1 \iff x,x^{-1} \in \mathcal{O}_K \iff x \in \mathcal{O}_K^\times$.
    \end{enumerate}
\end{proof}

\textbf{Notation.} Let $\mathfrak{m} = \{x \in \mathcal{O}_K \mid |x|<1\}$. It turns out this is a maximal ideal in $\mathcal{O}_K$. Also let $\mathfrak{k} = \mathcal{O}_K/\mathfrak{m}$, the residue field. 

\begin{cor}
    $\mathcal{O}_K$ is a \textbf{local ring} (i.e. a ring with a unique maximal ideal) with unique maximal ideal $\mathfrak{m}$.
\end{cor}
\begin{proof}
    Let $\mathfrak{m'}$ be a maximal ideal. If $\mathfrak{m'} \neq \mathfrak{m}$, then $\exists x \in \mathfrak{m'}\setminus \mathfrak{m}$. Hence $|x|= 1$, so by (iii) above, $x$ is a unit, so $\mathfrak{m'}=\mathcal{O}_K$, a contradiction.
\end{proof}

\begin{example}
    $K=\mathbb{Q}$ with $|\cdot|_p$. Then $\mathcal{O}_K = \mathbb{Z}_{(p)} = \{\frac{a}{b} \in \mathbb{Q} \mid p \nmid b\}$. In this case, $\mathfrak{m} = p\mathbb{Z}_{(p)}$ and $\mathfrak{k} = \mathbb{F}_p$.
\end{example}

\begin{defn}
    Let $v:K^{\times} \to \mathbb{R}$ be a valuation. If $v(K^{\times}) \cong \mathbb{Z}$, then we say $v$ is a \textbf{discrete valuation}. In this case, $K$ is said to be a \textbf{discretely valued field}. 
    \vspace{1mm}
     
    An element $\pi \in \mathcal{O}_K$ is said to be a \textbf{uniformizer} if $v(\pi)>0$ and $v(\pi)$ generates $v(K^\times)$.
\end{defn}
\begin{example}
    \begin{itemize}
        \item $K=\mathbb{Q}$ with the $p$--adic valuation and $K=k(t)$ with the $t$--adic valuation are discretely valued fields.
        \item $K=k(t)(t^{\frac{1}{2}}, t^{\frac{1}{4}}, t^{\frac{1}{8}},\ldots)$ with the $t$--adic valuation is not a discretely valued field.
    \end{itemize}
\end{example}
\textbf{Remark.} If $v$ is a discrete valuation, we can scale $v$, i.e. replace it with an equivalent valuation such that $v(K^\times) = \mathbb{Z}$. Such $v$ are called \textbf{normalized valuations}. Then $\pi$ is a uniformizer $\iff v(\pi) = 1$.

\begin{lemma}
    Let $v$ be a valuation on $K$. Then the following are equivalent:
    \begin{enumerate}[(i)]
        \item $v$ is discrete;
        \item $\mathcal{O}_K$ is a PID;
        \item $\mathcal{O}_K$ is Noetherian;
        \item $\mathfrak{m}$ is principal.
    \end{enumerate}
\end{lemma}
\begin{proof}
    (i) $\implies$ (ii): $\mathcal{O}_K \subset K$, so $\mathcal{O}_K$ is an integral domain. Let $I \subset \mathcal{O}_K$ be a nonzero ideal and pick $x \in I$ such that $v(x) = \min \{v(a) \mid a \in I, a \neq 0\}$, which exists as $v$ is discrete. Then we claim that $x \mathcal{O}_K = \{a \in \mathcal{O}_K \mid v(a)\ge v(x)\}$ is equal to $I$. The inclusion $x\mathcal{O}_K\subset I$ is clear, as $I$ is an ideal. For $x\mathcal{O}_K\supset I$, let $y \in I$, then $v(x^{-1}y) = v(y) - v(x) \ge 0 \implies y = x(x^{-1}y) \in x \mathcal{O}_K$.
    \vspace{1mm}
     
    (ii) $\implies $ (iii): Clear, as being a PID means every ideal is generated by one element, i.e. by finitely many. 
    \vspace{1mm}
     
    (iii) $\implies $ (iv): Write $\mathfrak{m} = x_1 \mathcal{O}_K +\ldots+ x_n \mathcal{O}_K$ and WLOG assume $v(x_1)\le v(x_2)\le \ldots\le v(x_n)$. Then $x_2,\ldots,x_n \in x_1 \mathcal{O}_K$, since $x_1 \mathcal{O}_K = \{a \in \mathcal{O}_K \mid v(a) \ge v(x_1)\}$, so $\mathfrak{m} = x_1 \mathcal{O}_K$.
    \vspace{1mm}
     
    (iv) $\implies $ (i): Let $\mathfrak{m} = \pi \mathcal{O}_K$ for some $\pi \in \mathcal{O}_K$ and let $c = v(\pi)$. Then if $v(x)>0$, i.e. $x \in \mathfrak{m}$, then $v(x) \ge c$. Thus $v(K^\times) \cap (0,c) = \varnothing$. Since $v(K^\times)$ is a subgroup of $(\mathbb{R}, +)$, we have $v(K^{\times}) = c\mathbb{Z}$.
\end{proof}

\marginpar{12 Oct 2022, Lecture 3}

\textbf{Remark.} Let $v$ be a discrete valuation on $K$, $\pi \in \mathcal{O}_K$ a uniformizer. For $x \in K^{\times}$, let $n \in \mathbb{Z}$ such that $v(x) = n v(\pi)$. Then $u = x \pi^{-n} \in \mathcal{O}_K^{\times}$ and $x = u \pi^n$. In particular, $K = \mathcal{O}_K \left[\frac{1}{\pi}\right]$ and hence $K = \text{Frac}(\mathcal{O}_K)$.

\begin{defn}
    A ring $R$ is called a \textbf{discrete valuation ring} (DVR) if it is a PID with exactly one nonzero prime ideal (which is then necessarily maximal).
\end{defn}
\begin{lemma}
    \begin{enumerate}[(i)]
        \item Let $v$ be a discrete valuation on $K$. Then $\mathcal{O}_K$ is a DVR.
        \item Let $R$ be a DVR. Then there exists a valuation $v$ on $K = \text{Frac}(R)$ such that $R = \mathcal{O}_K$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    \begin{enumerate}[(i)]
        \item $\mathcal{O}_K$ is a PID by the previous lemma, hence any nonzero prime ideal is maximal. Since $\mathcal{O}_K$ is a local ring, it is a DVR.
        \item Let $R$ be a DVR with maximal ideal $\mathfrak{m}$. Then $\mathfrak{m} = (\pi)$ for $\pi \in R$. Since PIDs are UFDs, we can write any nonzero $x \in R$ uniquely as $\pi^n u$ for some $n \ge 0$, $u$ a unit (since $\pi$ is the only prime). Then any $y \in K^{\times}$ can be written uniquely as $\pi^m u$, $m \in \mathbb{Z}$. Define $v(\pi^m u) = m$. Exercise: check that this is a valuation and $R = \mathcal{O}_K$.
    \end{enumerate}
\end{proof}
\begin{example}
    $\mathbb{Z}_{(p)}$, $R[[t]]$ for $R$ a field are DVRs.
\end{example}

\section{$p$--adic numbers}

Recall that $\mathbb{Q}_p$ is the completion of $\mathbb{Q}$ with respect to $|\cdot|_p$. It is an exercise on example sheet 1 to show that $\mathbb{Q}_p$ is a field. Moreover, $|\cdot|_p$ extends to $\mathbb{Q}_p$ and the associated valuation is discrete (example sheet again).
\begin{defn}
    The \textbf{ring of $p$--adic integers} $\mathbb{Z}_p$ is the valuation ring  \[
    \mathbb{Z}_p = \{x \in \mathbb{Q}_p \mid |x|_p \le 1\}.
    \]
\end{defn}
\textbf{Facts.} $\mathbb{Z}_p$ is a DVR and has a principal maximal ideal $p\mathbb{Z}_p$. In $\mathbb{Z}_p$, all nonzero ideals are given by $p^n \mathbb{Z}_p$. 
\begin{prop}
    $\mathbb{Z}_p$ is the closure of $\mathbb{Z}$ inside $\mathbb{Q}_p$. In particular, $\mathbb{Z}_p$ is the completion of $\mathbb{Z}$ with respect to $|\cdot|_p$.
\end{prop}
\begin{proof}
    We need to show $\mathbb{Z}$ is dense in $\mathbb{Z}_p$. Note $\mathbb{Q}$ is dense in $\mathbb{Q}_p$. Since $\mathbb{Z}_p \subset \mathbb{Q}_p$ is open, $\mathbb{Z}_p \cap \mathbb{Q}$ is dense in $\mathbb{Z}_p$. But $$\mathbb{Z}_p \cap \mathbb{Q} = \{x \in \mathbb{Q}\mid |x|_p \le 1\} = \left\{\frac{a}{b} \in \mathbb{Q} \mid  p \nmid b\right\} = \mathbb{Z}_{(p)}.$$
    Thus it suffices to show that $\mathbb{Z}$ is dense in $\mathbb{Z}_{(p)}$. Let $\frac{a}{b} \in \mathbb{Z}_{(p)}$ with $a,b \in \mathbb{Z}$ and $p \nmid b$. For $n \in \mathbb{N}$, choose $y_n \in \mathbb{Z}$ such that $by_n \equiv a \pmod{p^n}$. Then $y_n \to \frac{a}{b}$ as $n \to \infty$. 
    \vspace{1mm}
     
    For the last part, note that $\mathbb{Z}_p$ is complete (as it is a closed subset of a complete space) and $\mathbb{Z} \subset \mathbb{Z}_p$ is dense.
\end{proof}

\textbf{Inverse limits.} Let $(A_n)_{n=1}^\infty$ be a sequence of sets/groups/rings together with homomorphisms $\phi_n : A_{n+1} \to A_n$ (called \textbf{transition maps}). Then the \textbf{inverse limit} of $(A_n)_{n=1}^\infty$ is the set/group/ring \[
\underset{n}{\varprojlim} A_n = \left\{(a_n)_{n=1}^\infty \in \prod_{n=1}^{\infty} A_n \mid \phi_n(a_{n+1}) = a_n ~\forall n\right\}. 
\]
\textbf{Fact.} If $A_n$ is a group/ring, then the inverse limit is also a group/ring. Here the group/ring operations are defined componentwise. Let $\theta_m : \underset{n}{\varprojlim} A_n \to A_m$ denote the natural projection.
\vspace{1mm}
 
The inverse limit satisfies the following universal property:
\begin{prop}
    For any set/group/ring $B$ together with homomorphisms $\psi_n : B \to A_n$ such that the following diagram commutes,
    \[\begin{tikzcd}[row sep=large,column sep=large]
        B & A_{n+1} \\
        & A_n
        \arrow["\psi_{n+1}", from=1-1, to=1-2]
        \arrow["\psi_n", from=1-1, to=2-2]
        \arrow["\phi_n", from=1-2, to=2-2]
    \end{tikzcd}\]
    there exists a unique homomorphism $\psi : B \to \underset{n}{\varprojlim} A_n$ such that $\theta_n \circ \psi = \psi_n$ for all $n$.
\end{prop} 
\begin{proof}
    Define $\psi : B \to \prod_{n=1}^{\infty} A_n$ by $b \mapsto (\psi_n(b))_{n=1}^{\infty}$. Then $\psi_n = \theta_n \circ \psi_{n+1} \implies \psi(b) \in \underset{n}{\varprojlim} A_n$. This map is clearly unique (determined by $\psi_n = \phi_n \circ \psi_{n+1}$), and is a homomorphism of sets/groups/rings.
\end{proof}
\begin{defn}
    Let $I \subset R$ be an ideal (in a ring $R$). The \textbf{$I$--adic completion of $R$} is the ring $\hat{R} = \underset{n}{\varprojlim} R/I^n$ where $R/I^{n+1} \to R/I^n$ is the natural projection.
\end{defn}
Note that there exists a natural map $i : R \to \hat{R}$ by the universal property (since there exist maps $R \to R/I^n$).
\begin{defn}
    We say $R$ is \textbf{$I$--adically complete} if $i$ is an isomorphism.
\end{defn}
\textbf{Fact.} $\text{ker}(i : R \to \hat{R}) = \bigcap_{n=1}^{\infty} I^n$ (check!). 
\vspace{1mm}
 
Let $(K, |\cdot|)$ be a non--archimedean valued field and $\pi \in \mathcal{O}_K$  such that $|\pi|<1$.
\begin{prop}
    Assume $K$ is complete with respect to $|\cdot|$. Then:
    \begin{enumerate}[(i)]
        \item $\mathcal{O}_K \stackrel{i}{\cong} \underset{n}{\varprojlim} \mathcal{O}_K/\pi^n \mathcal{O}_K$ (i.e. $\mathcal{O}_K$ is $\pi$--adically complete)\footnote{There a bit of abuse of notation here -- really, $\mathcal{O}_K$ is $(\pi)$--adically complete.}.
        \item Every $x \in \mathcal{O}_K$ can be written uniquely as $x = \sum_{i=0}^{\infty} a_i \pi^i$ with $a_i \in A$, where $A \subset \mathcal{O}_K$ is a set of coset representatives for $\mathcal{O}_K/\pi \mathcal{O}_K$. Moreover, any such power series converges (in $\mathcal{O}_K$).
    \end{enumerate}
\end{prop} 
\begin{proof}
    \begin{enumerate}[(i)]
        \item $K$ is complete and $\mathcal{O}_K \subset K$ is closed, so $\mathcal{O}_K$ is complete. If $x \in \bigcap_{n=1}^{\infty} \pi^n \mathcal{O}_K$, then $v(x) \ge n v(\pi) ~\forall n \implies x = 0$, hence the natural map $\mathcal{O}_K \to \underset{n}{\varprojlim} \mathcal{O}_K/\pi^n \mathcal{O}_K$ is injective.
        
        For surjectivity, let $(x_n)_{n=1}^{\infty} \in \underset{n}{\varprojlim}\mathcal{O}_K/ \pi^n \mathcal{O}_K$ and for each $n$, let $y_n \in \mathcal{O}_K$ be a lifting\footnote{Given a surjective map $G \to G'$, a lift of an element $x \in G'$ is a choice of $y \in G$ such that $y \mapsto x$ under this map.} of $x_n \in \mathcal{O}_K/\pi^n \mathcal{O}_K$. Then $y_n - y_{n+1}  \in \pi^n \mathcal{O}_K$, thus $(y_n)_{n=1}^{\infty}$ is a Cauchy sequence in $\mathcal{O}_K$. Let $y_n \to y \in \mathcal{O}_K$. Then $y$ maps to $(x_n)_{n=1}^\infty$ in $\underset{n}{\varprojlim} \mathcal{O}_K/\pi^n \mathcal{O}_K$.
        \item Left as exercise on example sheet 1.
    \end{enumerate}
\end{proof}
\begin{cor}
    \begin{enumerate}[(i)]
        \item $\mathbb{Z}_p \cong \underset{n}{\varprojlim} \mathbb{Z}/p^n \mathbb{Z}$.
        \item Every element in $\mathbb{Q}_p$ can be written uniquely as $x = \sum_{i=n}^{\infty} a_i p^i$ where we have $a_i \in \{0,1,\ldots,p-1\}$.
    \end{enumerate}
\end{cor}
\marginpar{14 Oct 2022, Lecture 4}
\begin{proof}
    \begin{enumerate}[(i)]
        \item By the previous proposition, it suffices to show that $\mathbb{Z}/p^n\mathbb{Z} \cong \mathbb{Z}_p/p^n\mathbb{Z}$. Let $f_n : \mathbb{Z} \to \mathbb{Z}_p/p^n \mathbb{Z}_p$ be the natural map. Then $\text{ker}(f_n) =\{x \in \mathbb{Z} \mid |x|_p \le p^{-n}\} = p^n\mathbb{Z}$, thus the natural map $\mathbb{Z}/p^n\mathbb{Z} \to \mathbb{Z}_p/p^n \mathbb{Z}_p$ is injective. For surjectivity, take $\overline{z} \in \mathbb{Z}_p/p^n \mathbb{Z}_p$ and $c \in \mathbb{Z}_p$ a lift. Since $\mathbb{Z}$ is dense in $\mathbb{Z}_p$, there exists $x \in \mathbb{Z}$ such that $x \in c + p^n \mathbb{Z}_p$ ($p^n \mathbb{Z}_p$ is open in $\mathbb{Z}_p$). Then $f_n(x) = \overline{z}$, so $Z/p^n \mathbb{Z} \to \mathbb{Z}_p / p^n \mathbb{Z}_p$ is surjective.
        \item Follows from the second part of the previous proposition applied to $p^{-n} x \in \mathbb{Z}_p$ for some $n \in \mathbb{Z}$.
    \end{enumerate}
\end{proof}

\begin{example}
    We have $\frac{1}{1-p} = 1 + p + p^2 + p^3 + \ldots$ in $\mathbb{Q}_p$.
\end{example}

\section{Complete valued fields}

\subsection{Hensel's lemma}

\begin{theorem}[Hensel's lemma, version 1]
    Let $(K, |\cdot|)$ be a complete discretely valued field. Let $f(x) \in \mathcal{O}_K[x]$ and assume $\exists a \in \mathcal{O}_K$ such that $|f(a)| < |f'(a)|^2$ for $f'(a)$ the formal derivative. Then there exists a unique $x \in \mathcal{O}_K$ such that $f(x)=0$ and $|x-a|< |f'(a)|$.
\end{theorem}
\begin{proof}
    Let $\pi \in \mathcal{O}_K$ be a uniformizer and let $r = v(f'(a))$ where $v$ is a normalized valuation, i.e. $v(\pi)=1$. We inductively construct a sequence $(x_n)$ in $\mathcal{O}_K$ such that
    \begin{enumerate}[(i)]
        \item $f(x_n) \equiv 0 \pmod{\pi^{n+2r}}$.
        \item $x_{n+1} \equiv x_n \pmod{\pi^{n+r}}$.
    \end{enumerate}
    Take $x_1 = a$, so $f(x_1) \equiv 0 \pmod{\pi^{1+2r}}$. Now suppose we've constructed $x_1, \ldots, x_n$ satisfying the conditions. Then define $x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}$. Since $x_n \equiv x_1 \pmod{\pi^{r+1}}$, $v(f'(x_n)) = v(f'(x_1)) = r$ and hence $\frac{f(x_n)}{f'(x_n)} \equiv 0 \pmod{\pi^{n+r}}$ by (i). It follows that $x_{n+1} \equiv x_n \pmod{\pi^{n+r}}$, so (ii) holds.
    \vspace{1mm}
     
    Note that for $X, Y$ indeterminates, we can write $f(X+Y) = f_0(X) + f_1(X)Y + f_2(X)Y^2 + \ldots$, where $f_i \in \mathcal{O}_K[X]$ and $f_0(X) = f(X), f_1(X) = f'(X)$. Thus $f(x_{n+1}) = f(x_n) + f'(x_n)c + f_2(x_n)c^2 + \ldots$ for $c = - \frac{f(x_n)}{f'(x_n)}$. Since $c \equiv 0 \pmod{\pi^{n+r}}$ and $v(f_i(x_n)) \ge 0$, we have $f(x_{n+1}) \equiv f(x_n) + c f'(x_n) \pmod{\pi^{n+2r+1}}$ (since the other terms vanish), but this is $\equiv 0 \pmod{\pi^{n+2r+1}}$, so (i) holds.
    \vspace{1mm}
     
    This gives the construction of $(x_n)$. Property (ii) implies that $(x_n)$ is Cauchy, so let $x \in \mathcal{O}_K$ be the limit, $x_n \to x$. Then $f(x) = \lim_{n \to \infty} f(x_n) = 0$ by property (i). Moreover, (ii) implies $a = x_1 \equiv x_n \pmod{\pi^{r+1}} ~\forall n$, so $a \equiv x \pmod{\pi^{r+1}}$, thus $|x-a| < |f'(a)|$.
    \vspace{1mm}
     
    For uniqueness, suppose $x'$ also satisfies $f(x') = 0$ and $|x'-a|<|f'(a)|$. Set $\delta = x' - x \neq 0$. Then $|x'-a|<|f'(a)|$ and $|x-a|<|f'(a)|$, so the ultrametric inequality implies $|\delta| = |x'-x| < |f'(a)| = |f'(x)|$ (since $a \equiv x \pmod{\pi^{r+1}}$). But \[
    0 = f(x') = f(x+\delta) = \underbrace{f(x)}_{=0} + f'(x)\delta + \underbrace{\delta^2 \ldots}_{|\cdot|\le |\delta|^2}.
    \]
    Hence $|f'(x) \delta|\le |\delta|^2 \implies |f'(x)| \le |\delta|$, a contradiction.
\end{proof}
\begin{cor}
    Let $(K,|\cdot|)$ be a complete discretely valued field, let $f(x) \in \mathcal{O}_K[x]$ and let $\overline{c} \in k = \mathcal{O}_K/\mathfrak{m}$ be a simple root of $\overline{f}(x) = f(x) \pmod{\mathfrak{m}} \in k[x]$. Then there exists a unique $x \in \mathcal{O}_K$ such that $f(x) = 0$ and $x \equiv \overline{c} \pmod{\mathfrak{m}}$.
\end{cor}
\begin{proof}
    Apply Hensel's lemma to a lift $c \in \mathcal{O}_K$ of $\overline{c}$. Then $|f(c)| < 1 = |f'(c)|^2$ since $f'(c)$ is a simple root.
\end{proof}
\begin{example}
    Consider $f(x) = x^2-2$, which has a simple root mod 7. Thus $\sqrt{2} \in \mathbb{Z}_p \subset \mathbb{Q}_7$.
\end{example}
\begin{cor}
    $\mathbb{Q}_p^\times/(\mathbb{Q}_p^\times)^2 \cong \begin{cases}
        (\mathbb{Z}/2\mathbb{Z})^2 \text{ if } p>2.\\
        (\mathbb{Z}/2\mathbb{Z})^3 \text{ if } p=2.
    \end{cases}$
\end{cor}
\begin{proof}
    First consider $p>2$. Let $b \in \mathbb{Z}_p^\times$. Applying the previous corollary to $f(x) = x^2-b$, we find that $b \in (\mathbb{Z}_p^\times)^2$ if and only if $b \in (\mathbb{F}_p^\times)^2$. Thus $\mathbb{Z}_p^\times \to \mathbb{F}_p^\times/(\mathbb{F}_p^\times)^2$ has kernel $(\mathbb{Z}_p^\times)^2$, so induces an isomorphism $\mathbb{Z}_p^\times/(\mathbb{Z}_p^\times)^2 \to \mathbb{F}_p^\times/(\mathbb{F}_p^\times)^2 \cong (\mathbb{Z}/2\mathbb{Z})$ (since $\mathbb{F}_p^{\times} = \mathbb{Z}/(p-1)\mathbb{Z}$).
    \vspace{1mm}
     
    We have an isomorphism $\mathbb{Z}_p^\times \times \mathbb{Z} \to \mathbb{Q}_p^{\times}$ given by $(u,n) \mapsto up^n$. Then $\mathbb{Q}_p^\times / (\mathbb{Q}_p^\times)^2 \cong (\mathbb{Z}/2\mathbb{Z})^2$.
    \vspace{1mm}
     
    If $p=2$, let $b \in \mathbb{Z}_2^\times$. Consider $f(x) = x^2 - b$, so $f'(x) = 2x \equiv 0 \pmod{2}$. Instead now let $b \equiv 1 \pmod{8}$. Then $|f(1)|_2 \le 2^{-3} < 2^{-2} = |f'(1)|_2^2$. Hensel's lemma now implies that $b \in (\mathbb{Z}_2^\times)^2 \iff b \equiv 1 \pmod{8}$. Thus $\mathbb{Z}_2^\times / (\mathbb{Z}_2^\times)^2 \cong (\mathbb{Z}/8\mathbb{Z})^\times = (\mathbb{Z}/2\mathbb{Z})^2$. Again using $\mathbb{Q}_2^\times \cong \mathbb{Z}_2^\times \times \mathbb{Z}$, we obtain that $\mathbb{Q}_2^\times/(\mathbb{Q}_2^\times)^2 \cong (\mathbb{Z}/2\mathbb{Z})^3$. 
\end{proof}
\textbf{Remark.} The proof of Hensel's lemma uses the iteration $x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}$. We can think of the proof as the non--archimedean analogue of the Newton-Raphson method.

\begin{theorem}[Hensel's lemma, version 2]
    Let $(K, |\cdot|)$ be a complete discretely valued field and $f(x) \in \mathcal{O}_K[x]$. Suppose $\overline{f}(x) = f(x) \pmod{\mathfrak{m}} \in k[x]$ factorizes as $\overline{f}(x) = \overline{g}(x)\overline{h}(x) \in k[x]$ with $\overline{g}(x), \overline{h}(x)$ coprime. Then there is a factorization $f(x) = g(x)h(x)$ in $\mathcal{O}_K[x]$ with $\overline{g}(x) \equiv g(x) \pmod{\mathfrak{m}}$, $\overline{f}(x) \equiv f(x) \pmod{\mathfrak{m}}$ and $\text{deg}(\overline{g}) = \text{deg}(g)$.
\end{theorem}
\begin{proof}
    Left as an exercise on example sheet 1.
\end{proof}

\end{document}