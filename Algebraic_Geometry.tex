\documentclass{article}
%build with recipe latexmk
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage{fancyhdr}
\pagestyle{fancy}

\usepackage{tcolorbox}
\tcbuselibrary{theorems}
\usepackage{babel}
\usepackage{enumerate}
\usepackage{stmaryrd}
\usepackage{amsmath, amssymb, amsthm}
%\usepackage{a4wide}
\usepackage{float}
\usepackage{tikz-cd}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{wrapfig}
\usepackage{setspace}
\setstretch{1.1}
\usepackage{color}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true, %set true if you want colored links
    linktoc=all,     %set to all if you want both sections and subsections linked
    linkcolor=black,  %choose some color if you want links to stand out
}

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{cor}[theorem]{Corollary}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{example}{Example}[section]
\newtheorem{defn}{Definition}[section]

\title{Part III - Algebraic Geometry
    \\ \large
    Lectured by Dhruv Ranganathan 
}
 
\author{Artur Avameri}
\date{}
 
\setcounter{section}{-1}
 
\begin{document}
\maketitle
\tableofcontents
\newpage
 
\section{Introduction}

\marginpar{6 Oct 2022, Lecture 1}


The course consists of four parts.
\begin{enumerate}[(1)]
    \item Basics of sheaves on topological spaces.
    \item Definition of schemes and morphisms.
    \item Properties of schemes (e.g. the algebraic geometry notion of compactness and other properties).
    \item A rapid introduction to the cohomology of schemes.
\end{enumerate}

The main reference for the course is Hartshorne's \textit{Algebraic Geometry}.

\section{Beyond algebraic varieties}
\marginpar{08 Oct 2022, Lecture 2}

\subsection{Summary of classical algebraic geometry}
We let $k = \overline{k}$ be a algebraically closed field and consider $\mathbb{A}_k^n = \mathbb{A}^n = k^n$ as a set.

\begin{defn}
    An \textbf{affine variety} is a subset $V \subset \mathbb{A}^n$ of the form $\mathbb{V}(S)$ with $S \subset k[x_1,\ldots,x_n]$, where $\mathbb{V}$ is the common vanishing locus.
\end{defn}
Note that $\mathbb{V}(S) = \mathbb{V}(I(S))$ (the ideal generated by $S$). By Hilbert Basis Theorem (since $k[x_1,\ldots,x_n]$ is noetherian), $\mathbb{V}(I(S)) = \mathbb{V}(S')$ for some finite set $S \subset k[x_1,\ldots,x_n]$.
\vspace{1mm}
 
In fact, $\mathbb{V}(I) = \mathbb{V}(\sqrt{I})$, where \[
\sqrt{I} = \{ f \in k[x_1,\ldots,x_n] \mid f^m \in I \text{ for some } m\ge 0\}
\] 
is the \textbf{radical} of $I$.
For example, in $k[x]$, if $I = (x^2)$, then $\sqrt{I} = (x)$.

\begin{defn}
    Given varieties $V \subset \mathbb{A}^n$ and $W \subset  \mathbb{A}^m$, a \textbf{morphism} is a (set-theoretic) map $\phi : V \to W \subset \mathbb{A}_k^m$ such that if $\phi = (f_1,\ldots,f_m)$, then each $f_i$ is the restriction of a polynomial in $\{x_1,\ldots,x_n\}$.
    \vspace{1mm}
     
    An \textbf{isomorphism} is a morphism with a two--sided inverse.  
\end{defn}

Our basic correspondence is 
\begin{align*}
    \{\text{Affine varieties over }k\}&/\text{up to isomorphism}\\  &\leftrightarrow \\ \{\text{finitely generated }k\text{--algebras }A &\text{ without nilpotent elements}\}
\end{align*}
A finitely generated $k$--algebra is just a quotient of a polynomial ring in finitely many variables. A nilpotent element is such that some power of it is zero. For example, in $k[x]/(x^2)$, the element $x$ is nilpotent.
\vspace{1mm}
 
How does this correspondence work? Given a variety $V$ (representing an isomorphism class), we write $V = \mathbb{V}(I)$ for $I \subset k[x_1,\ldots,x_n]$ a radical ideal\footnote{A radical ideal is an ideal equal to its radical.}, and map $V \mapsto k[x_1,\ldots,x_n]/I$.
\vspace{1mm}
 
For the reverse, if $A$ is a finitely generated nilpotent free algebra, then $A \cong k[y_1,\ldots,y_m]/J$ where we can choose $J$ to be radical (exercise: why?).
\vspace{1mm}
 
We have to check that this is independent of our choice on both sides (exercise: think through this, it should be clear).

\begin{defn}
    The algebra associated to $V$ is classically denoted $k[V]$ and called the \textbf{coordinate ring of} $V$.
\end{defn}

We have the compatibility of morphisms with our basic correspondence: there is a bijection between \[
\text{Morphisms}(V, W) \leftrightarrow \text{Ring homomorphisms}_k(k[W], k[V])
\]
(here $\text{RingHom}_k$ means that our homomorphisms preserve $k$).

We can now make our set into a topological space:
\begin{defn}
    Let $V = \mathbb{V}(I) \subset \mathbb{A}^n$ be a variety with coordinate ring $k[V]$. The \textbf{Zariski topology} on $V$ is defined such that the closed sets are $\mathbb{V}(S)$, where $S \subset k[V]$.
\end{defn}
If $V \cong W$, then the Zariski topological spaces are homeomorphic as varieties (exercise).

\begin{theorem}[Nullstellensatz]
    Fix $V$ a variety and let $k[V]$ be its coordinate ring. Given $p \in V$, we can produce a homomorphism $\text{ev}_p : k[V] \to k$ by sending $f \mapsto f(p)$. Note that $\text{ev}_p$ is surjective (since we have constant functions), hence $\text{ker}(\text{ev}_p) = m_p$ is a maximal ideal, giving us a map \[
        \{\text{points of }V\} \rightarrow \{\text{maximal ideals in }k[V]\}.
    \]
    Nullstellensatz says that this is actually a bijection. For the converse map, given $m \subset k[V]$, we get a quotient $k[V] \to k[V]/m = k$ (Nullstellensatz says this extension is finite, hence must be $k$). So using/choosing a representation for $V$ in $k[x_1,\ldots,x_n]$ gives a surjective homomorphism onto $k$ and specifies a bunch of points.
\end{theorem}
\subsection{Limitations of classical algebraic geometry}
\textbf{Question.} What is an abstract variety, i.e. ''some ''space'' $X$ such that  locally as a cover $\{U_i\}$, each $U_i$ is an affine variety, compatible with overlaps''. 

\begin{example}[non--algebraically closed fields]
    Take $I = (x^2+y^2+1) \subset \mathbb{R}[x,y]$. Then $\mathbb{V}(I) = \varnothing \subset \mathbb{R}^2$, but $I$ is prime, so radical, so nullstellensatz fails.
\end{example}

\textbf{Question.} On what topological space is $\mathbb{R}[x,y]/(x^2+y^2+1)$ ''naturally'' the set of functions? (or $\mathbb{Z}$, or $\mathbb{Z}[x]$).

\begin{example}[Why restrict to radical ideals?]
    Take $C = \mathbb{V}(y-x^2) \subset \mathbb{A}_k^2$ and $D = \mathbb{V}(x,y)$, so $C \cap D = \mathbb{V}(y, y-x^2) = \mathbb{V}(x,y) = \{(0,0)\}$. This is a single point, but if $D_\delta = \mathbb{V}(y+\delta)$ for some $\delta \in k$, then $C \cap D_\delta = \{\pm \sqrt{\delta}\}$, which is 2 points for all $\delta \neq 0$. In other words, intersections of varieties don't want to be varieties.
\end{example}

\subsection{The spectrum of a ring}

\marginpar{11 Oct 2022, Lecture 3}

Let $A$ be a commutative ring with identity. We will define a topological space on which $A$ is the ring of functions.

\begin{defn}
    The \textbf{Zariski spectrum} of $A$ is $$\text{Spec }A = \{\mathfrak{p} \subset A \mid \mathfrak{p} \text{ is a prime ideal}\}.$$
\end{defn}
A ring homomorphism $\phi : A \to B$ induces a map $\phi^{-1} : \text{Spec }B \to \text{Spec }A$ by $q \mapsto \phi^{-1}(q)$. In general, the preimage of a prime ideal is a prime ideal.
\vspace{1mm}
 
\textbf{Warning.} This would fail if we only considered maximal ideals, since the preimage of a maximal ideal need not be maximal. 
\vspace{1mm}
 
Given $f \in A$ and $\mathfrak{p} \in \text{Spec}(A)$, we have an induced $\overline{f} \in A/\mathfrak{p}$ obtained via a quotient. Informally, we can evaluate any $f \in A$ at points $\mathfrak{p} \in \text{Spec}(A)$ with the caveat that the codomain of this evaluation depends on $\mathfrak{p}$.

\begin{example}
    Take $A = \mathbb{Z}$. Then $\text{Spec }A  = \text{Spec }(\mathbb{Z}) = \{p \mid p \text{ is prime}\} \cup \{(0)\}$. Let's pick an element in $\mathbb{Z}$, say $132 \in \mathbb{Z}$. Given a prime $p$, we can look at ${132\pmod{p}} \in \mathbb{Z}/p$. The takeaway here is that 
    \begin{align*}
        \text{Spec }\mathbb{Z} &\rightarrow \text{Space}\\
        132 \in \mathbb{Z} &\rightarrow \text{a function}\\
        132 \text{ (mod }p) &\rightarrow \text{value of that function at }p.
    \end{align*}
    Note that based on the value of $p$, our codomain changes from point to point.
\end{example}
\begin{example}
    Take $A = \mathbb{R}[x]$, then $\text{Spec }\mathbb{R}[x] = \mathbb{C}/ \text{complex conjugation} \cup \{(0)\}$. 
\end{example}
\textbf{Exercise.} Draw $\text{Spec }\mathbb{Z}[x]$ and $\text{Spec }k[x]$ for $k$ any field (i.e. describe all prime ideals and their containment). This is on example sheet 1.
\begin{example}
    If $A = \mathbb{C}[x]$, then $\text{Spec }A = \mathbb{C} \cup\{(0)\}$, where given $a \in \mathbb{C}$, we send it to the maximal ideal $\langle z-a\rangle$.
\end{example}
\subsection{A topology on Spec $A$}
Fix $f \in A$. Then $\mathbb{V}(f) = \{\mathfrak{p} \in \text{Spec }A \mid f \equiv 0 \pmod{\mathfrak{p}}\} \subset \text{Spec }A$. (Note that $f \equiv 0 \pmod{\mathfrak{p}}$ is the same as $f  \in \mathfrak{p}$). \vspace{1mm}
 
Similarly for $J \subset A$ an ideal, $\mathbb{V}(J) = \{\mathfrak{p} \in \text{Spec }A \mid f \in \mathfrak{p} ~\forall f \in J\}$.

\begin{prop}
    The sets $\mathbb{V}(J) \subset \text{Spec }A$ ranging over all ideals $J$ form the closed sets of a topology on $\text{Spec }A$. This topology is called the \textbf{Zariski topology}.
\end{prop}
\begin{proof}
    Easy fact: $\varnothing$ and $\text{Spec }A$ are closed, since we have functions $1$ (vanishing nowhere) and $0$ (vanishing everywhere). Since $\mathbb{V}(\sum_{\alpha}^{} I_\alpha) = \bigcap_\alpha \mathbb{V}(I_\alpha)$ (this is because $I_1 + I_2$ is the smallest ideal containing $I_1 \cup I_2$), arbitrary intersections are closed.
    \vspace{1mm}
     
    Finally, we claim $\mathbb{V}(I_1) \cup \mathbb{V}(I_2) = \mathbb{V}(I_1 \cap I_2)$. The containment $\subset $ is clear: if a prime ideal contains $I_1$ or $I_2$, it contains $I_1 \cap I_2$. Conversely, $I_1I_2 \subset I_1 \cap I_2$, so if $I_1 I_2 \subset I_1 \cap I_2 \subset \mathfrak{p}$, then by primality $I_1 \subset \mathfrak{p}$ or $I_2 \subset \mathfrak{p}$. 
\end{proof}

\begin{example}
    Let $k = \mathbb{C}$ and consider $\text{Spec }\mathbb{C}[x,y]$. We make a few observations:
    \begin{itemize}
        \item The point $(0) \in \text{Spec }\mathbb{C}[x,y]$ is dense in the Zariski topology, i.e. $\overline{\{(0)\}} = \text{Spec }\mathbb{C}[x,y]$ because every prime ideal contains $(0)$ (because we are in an integral domain).
        \item Consider the prime ideal $(y^2-x^3)$ (which is prime since the quotient is an integral domain). Consider a maximal ideal $\mathfrak{m}_{a,b} = (x-a, y-b)$. We can ask: when is $\mathfrak{m}_{a,b} \in \overline{\{(y^2-x^3)\}}$? The answer: if and only if $b^2 = a^3$, e.g. $(1,1)$ (see example sheet 1). The lesson here is that points are not closed in the Zariski topology.
    \end{itemize}
\end{example}
\subsection{Functions on opens}
\begin{defn}
    Let $f \in A$. Define the \textbf{distinguished open} corresponding to $f$ to be \[
    \mathcal{U}_{f} = (\text{Spec}(A))/\mathbb{V}(f).
    \]
\end{defn}
\begin{example}
    \begin{itemize}
        \item Let $A = \mathbb{C}[x]$, so $\text{Spec }A = \mathbb{C} \cup \{(0)\}$ (with the Zariski topology). Take $f = x$ and consider $\mathcal{U}_x$. Recall the bijection $\text{Spec }\mathbb{C} \leftrightarrow \mathbb{C} \cup \{(0)\}$ by $(x-a) \mapsfrom a \in \mathbb{C}$ and $(0) \mapsfrom (0)$. Then $\mathbb{V}(x) = \{\mathfrak{p} \in \text{Spec }A \mid x \in \mathfrak{p}\} = \{(x)\}$, so $\mathcal{U}_f = \text{Spec }A \setminus \{(x)\}$.
        \item More generally, suppose we fix $a_1,\ldots,a_r \in \mathbb{C}$, then $\text{Spec }A\setminus \{(x-a_i)\}_{i=1}^r = \mathcal{U}$ and $\mathcal{U} = \mathcal{U}_f$, where $f = \prod_{i=1}^{r} (x-a_i)$.
    \end{itemize}
\end{example}
\begin{lemma}
    The distinguished opens $\mathcal{U}_f$ taken over all $f \in A$ form a basis for the Zariski topology on $\text{Spec }A$.
\end{lemma}
\begin{proof}
    Left as an exercise on example sheet 1.
\end{proof}

A bit of commutative algebra: 
\begin{defn}
    Given $f \in A$, the \textbf{localization of $A$ at $f$} is $A_f = A[x]/(xf-1)$, which we can informally think of as $A_f = A[\frac{1}{f}]$.
\end{defn}
\begin{lemma}
    The distinguished open $\mathcal{U}_f \subset \text{Spec }A$ is naturally homeomorphic to $\text{Spec }A_f$ via the ring homomorphism $A \stackrel{j}{\to} A_f$, which produces the inverse $j^{-1}: \text{Spec }A_f \to \text{Spec }A$.
\end{lemma}
\marginpar{13 Oct 2022, Lecture 4}
\begin{proof}
    Primes in the ring $A_f$ are in bijection with primes of $A$ that miss $f$ via $j^{-1}$. We exhibit this bijection: 
    \begin{itemize}
        \item Given $q \subset A_f$ prime, take $j^{-1}(q) \subset A$, which is prime. 
        \item Given $p \subset A$ a prime ideal, take $p_f = j(p) A_f$. We claim $p_f$ is a prime exactly when $f \not\in p$.
        \begin{itemize}
            \item If $f \in p$, then $p_f$ contains $f$, which is a unit, so $p_f = (1)$ is not prime.
            \item If $f \not\in p$, then $\left( A_f/p_f \right) \cong \left( A/p\right)_{\overline{f}}$, where $\overline{f}$ is $f + p$, a coset (exercise: check this formally). Hence $\left(A/p \right)_{\overline{f}} \subset FF \left(A/p \right)$ (FF stands for fraction field), so it is an integral domain, so $p_f$ is prime.
        \end{itemize}
    \end{itemize}
    Finally we need to check that these maps are inverses. This is left as an exercise.
\end{proof}

Facts about distinguished opens:
\begin{itemize}
    \item $U_f \cap U_g = U_{fg}$ (easy fact).
    \item $U_{f^n} = U_f$ for all $n \ge 1$ (easy fact).
    \item The rings $A_f$ and $A_{f^n}$ for $n\ge 1$ are isomorphic. Why? Since $A_f = A[x]/(xf-1)$ and $A_{f^n} = A[y]/(yf^n-1)$, the isomorphism is given by $A_f \to A_{f^n}$ by $x \mapsto f^{n-1}y$ and $A_{f^n} \to A_f$ by $y \mapsto x^n$ (check these are inverses).
    \item Containment. $U_{f} \subset U_{g} \iff f^n$ is a multiple of $g$ for some $n\ge 1$. To orient ourselves: if $f = g f'$, then $U_f \subset U_g$.
    \begin{proof}
        The $(\implies )$ direction is clear by the orientation above. Conversely, suppose $U_f \subset U_g$, so $\mathbb{V}(f) \supset \mathbb{V}(g)$. The set $\mathbb{V}(f)$ is the set of all primes containing $(f)$. We claim that $\sqrt{(f)} \subset \sqrt{(g)}$. But what is the radical of $I$? It is the intersection of all primes containing the ideal $I$.
    \end{proof}
\end{itemize}

Foreshadowing: fix $A$. We've made an assignment from distinguished opens in $\text{Spec }A$ to rings by mapping $U_f \mapsto A_f$. The association is ''functorial'', i.e. if $U_{f_1} \subset U_{f_2}$, then we can assume that $f_1^n = f_2 f_3$, so $U_{f_1} = U_{f_1^n} = U_{f_2f_3} \subset U_{f_2}$, so there is a homomorphism $A_{f_2} \to A_{f_1}$. This is the restriction map.

\vspace{1mm}
 
Question: can we extend this association to all open sets? See notes for the answer (yes).

\section{Sheaves}
\subsection{Presheaves}
Let $X$ be a topological space. 
\begin{defn}
    A \textbf{presheaf $\mathcal{F}$ on $X$ of abelian groups} is an association from the set of open sets in $X$ to abelian groups given by $U \mapsto \mathcal{F}(U)$ and for $U \subset V$ opens, a homomorphism $\text{res}_u^v : \mathcal{F}(V) \to \mathcal{F}(U)$ (a \textbf{restriction map}) such that $\text{res}_u^u = \text{id}$ and $\text{res}^v_u \circ \text{res}^w_v = \text{res}^w_u$ when $U \subset V \subset W$ are opens.
\end{defn}
\begin{example}
    For any space $X$, take $\mathcal{F}(U) = \{f : U \to \mathbb{R} \mid f \text{ continuous}\}$ with the usual restriction.
\end{example}
Similarly we can get sheaves of rings, sets, modules over a fixed ring, etc.

\begin{defn}
    A \textbf{morphism} $\phi : \mathcal{F} \to \mathcal{G}$ of presheaves on $X$ is, for each $U \subset X$ open, a homomorphism $\phi(u) : \mathcal{F}(u) \to \mathcal{G}(u)$ compatible with restriction maps, i.e. if $V \subset U$, then the following diagram commutes. 
    \[\begin{tikzcd}[row sep=large,column sep=large]
        \mathcal{F}(u) & \mathcal{G}(u) \\
        \mathcal{F}(v) & \mathcal{G}(v)
        \arrow["\phi(u)", from=1-1, to=1-2]
        \arrow["\text{res}^u_v",from=1-1, to=2-1]
        \arrow["\text{res}^u_v", from=1-2, to=2-2]
        \arrow["\phi(v)"', from=2-1, to=2-2]
    \end{tikzcd}\]
\end{defn}
\begin{defn}
    A morphism $\phi : \mathcal{F} \to \mathcal{G}$ of preshaves is injective (surjective) if $\phi(U) : \mathcal{F}(U) \to \mathcal{G}(U)$ is injective (surjective) for all $U \subset X$.
\end{defn}
\end{document}